services:
  - type: web
    name: cricdata-api
    env: docker
    plan: free
    healthCheckPath: /docs
    envVars:
      - key: DATABASE_URL
        value: sqlite:///./cricdata.db
      - key: API_HOST
        value: 0.0.0.0
      - key: API_PORT
        value: 8000
      - key: ENVIRONMENT
        value: production
      - key: API_KEY
        sync: false # This will prompt you to enter the value during deployment

  - type: cron
    name: cricdata-daily-update
    env: docker
    schedule: "0 1 * * *"  # Run at 1:00 AM every day (UTC)
    dockerCommand: python -m src.daily_update
    envVars:
      - key: DATABASE_URL
        value: sqlite:///./cricdata.db
      - key: API_KEY
        sync: false # Copy the same API key as the web service
